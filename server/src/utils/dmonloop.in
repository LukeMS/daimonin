#!/bin/sh
#
# This is the Daimonin loop & log script

CMDNAME="./daimonin_server"
maxrestart=500
logdir="data/log"
tmpdir="data/tmp"


logcount=0

rm -rf $logdir
mkdir $logdir

while [ ! "$logcount"x = "$maxrestart"x ]; do
  echo "Starting Daimonin `date` for the $logcount time..." 1>$logdir/$logcount 2>&1
  $CMDNAME -d 2>>$logdir/$logcount 1>&2
  if [ -f core ] ; then
        mv core core.$logcount
        @GZIP@ core.$logcount
  fi
  rm -fr $tmpdir/*
  logcount=`expr $logcount + 1`
  sleep 50
done
